<!DOCTYPE html>
<html>
   <head>
      <title>An Apple A Day | Doctor Finder</title>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=Edge">
      <meta name="description" content="">
      <meta name="keywords" content="">
      <meta name="author" content="">
      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
      <link rel="stylesheet" href="css/bootstrap.min.css">
      <link rel="stylesheet" href="css/font-awesome.min.css">
      <link rel="stylesheet" href="css/aos.css">
      <link rel="shortcut icon" href="images/favicon.png">
      <link href="css/english.css" rel="stylesheet" type="text/css">
      <link href="css/simplified_chinese.css" rel="alternate stylesheet" type="text/css" title="alternate">
      <!-- MAIN CSS -->
      <link rel="stylesheet" href="css/templatemo-digital-trend.css">
      <link rel="stylesheet" href="css/map.css">
   </head>
   <body>
<!--                         <script language="javascript">
                         chooseStyle('alternate', 60)
                        </script> -->
      <!-- MENU BAR -->
      <nav class="navbar navbar-expand-lg">
         <div class="container">
            <a class="navbar-brand" href="index.html">
               AN APPLE A DAY
               <h4>Let’s keep the hospital away</h4>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
               aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
               <ul class="navbar-nav ml-auto">
                  <li class="nav-item">
                     <a href="index.html" class="nav-link smoothScroll">Home</a>
                  </li>
                  <li class="nav-item">
                     <a href="symptom-checker2.html" class="nav-link smoothScroll">Symptom Checker</a>
                  </li>
                  <li class="nav-item">
                     <a href="symptom-explainer.html" class="nav-link smoothScroll">Conditions Explainer</a>
                  </li>
                  <li class="nav-item">
                     <a href="about.html" class="nav-link smoothScroll">About</a>
                  <li class="nav-item">
                     <!-- <a href="map-chinese.html" class="nav-link smoothScroll" onclick="setStylesheet(alternate)">中文</a> -->
                     <a href="map-chinese.html" class="nav-link smoothScroll" onclick="chooseStyle('alternate', 60)">中文</a>
                  </li>
               </ul>
            </div>
         </div>
      </nav>










      HEADING
      <section class="hero hero-bg d-flex justify-content-center align-items-center">
         <div class="container">
            <br><br>
            <h1 style="color: white;text-align:left;">DOCTOR FINDER</h1>
            <h3>Use the map below to find a doctor near you.</h3>
            <br><br>
         </div>
      </section>
      <br><br>




      <!-- The slide-out panel for showing place details-->
      <div id="panel"></div>
      <!-- Map appears here -->
      <div id="map"></div>
      <script>
         let pos;
         let map;
         let bounds;
         let infoWindow;
         let currentInfoWindow;
         let service;
         let infoPane;
         function initMap() {
             // Initialize variables
             bounds = new google.maps.LatLngBounds();
             infoWindow = new google.maps.InfoWindow;
             currentInfoWindow = infoWindow;
             infoPane = document.getElementById('panel');
         
             // Try HTML5 geolocation
             if (navigator.geolocation) {
                 navigator.geolocation.getCurrentPosition(position => {
                     pos = {
                         lat: position.coords.latitude,
                         lng: position.coords.longitude
                     };
                     map = new google.maps.Map(document.getElementById('map'), {
                         center: pos,
                         zoom: 15
                     });
                     bounds.extend(pos);
         
                     infoWindow.setPosition(pos);
                     infoWindow.setContent('You are here.');
                     infoWindow.open(map);
                     map.setCenter(pos);
         
                     // Call Places Nearby Search on user's location
                     getNearbyPlaces(pos);
                 }, () => {
                     // Browser supports geolocation, but user has denied permission
                     handleLocationError(true, infoWindow);
                 });
             } else {
                 // Browser doesn't support geolocation
                 handleLocationError(false, infoWindow);
             }
         }
         
         // Handle a geolocation error by adding default location (melbourne city)
         function handleLocationError(browserHasGeolocation, infoWindow) {
             pos = { lat: -37.8136, lng: 144.9631 };
             map = new google.maps.Map(document.getElementById('map'), {
                 center: pos,
                 zoom: 15
             });
         
             // Display error message
             infoWindow.setPosition(pos);
             infoWindow.setContent(browserHasGeolocation ?
                 'Geolocation permissions denied. Using default location.' :
                 'Error: Your browser doesn\'t support geolocation.');
             infoWindow.open(map);
             currentInfoWindow = infoWindow;
         
             // Call Places Nearby Search on the default location
             getNearbyPlaces(pos);
         }
         
         // Perform a Places Nearby Search Request
         function getNearbyPlaces(position) {
             let request = {
                 location: position,
                 rankBy: google.maps.places.RankBy.DISTANCE,
                 keyword: 'doctor clinic'
             };
         
             service = new google.maps.places.PlacesService(map);
             service.nearbySearch(request, nearbyCallback);
         }
         
         // Handle the results (up to 20) of the Nearby Search
         function nearbyCallback(results, status) {
             if (status == google.maps.places.PlacesServiceStatus.OK) {
                 createMarkers(results);
             }
         }
         
         // Set markers at the location of each place result
         function createMarkers(places) {
             places.forEach(place => {
                 let marker = new google.maps.Marker({
                     position: place.geometry.location,
                     map: map,
                     title: place.name
                 });
         
                 // Add click listener to each marker
                 google.maps.event.addListener(marker, 'click', () => {
                     let request = {
                         placeId: place.place_id,
                         fields: ['name', 'formatted_address', 'geometry', 'rating',
                             'website', 'photos']
                     };
         
                     /* Only fetch the details of a place when the user clicks on a marker to ensure we don't hit API rate limits. */
                     service.getDetails(request, (placeResult, status) => {
                         showDetails(placeResult, marker, status)
                     });
                 });
         
                 // Adjust the map bounds to include the location of this marker
                 bounds.extend(place.geometry.location);
             });
             /* Once all the markers have been placed, adjust the bounds of the map to
              * show all the markers within the visible area. */
             map.fitBounds(bounds);
         }
         
         // Builds an InfoWindow to display details above the marker
         function showDetails(placeResult, marker, status) {
             if (status == google.maps.places.PlacesServiceStatus.OK) {
                 let placeInfowindow = new google.maps.InfoWindow();
                 let rating = "None";
                 if (placeResult.rating) rating = placeResult.rating;
                 placeInfowindow.setContent('<div><strong>' + placeResult.name +
                     '</strong><br>' + 'Rating: ' + rating + '</div>');
                 placeInfowindow.open(marker.map, marker);
                 currentInfoWindow.close();
                 currentInfoWindow = placeInfowindow;
                 showPanel(placeResult);
             } else {
                 console.log('showDetails failed: ' + status);
             }
         }
         
         // Displays place details in a sidebar
         function showPanel(placeResult) {
             // If infoPane is already open, close it
             if (infoPane.classList.contains("open")) {
                 infoPane.classList.remove("open");
             }
         
             // Clear the previous details
             while (infoPane.lastChild) {
                 infoPane.removeChild(infoPane.lastChild);
             }
         
             // Add the primary photo, if there is one
             if (placeResult.photos) {
                 let firstPhoto = placeResult.photos[0];
                 let photo = document.createElement('img');
                 photo.classList.add('hero');
                 photo.src = firstPhoto.getUrl();
                 infoPane.appendChild(photo);
             }
         
             // Add place details with text formatting
             let name = document.createElement('h1');
             name.classList.add('place');
             name.textContent = placeResult.name;
             infoPane.appendChild(name);
             if (placeResult.rating) {
                 let rating = document.createElement('p');
                 rating.classList.add('details');
                 rating.textContent = `Rating: ${placeResult.rating} \u272e`;
                 infoPane.appendChild(rating);
             }
             let address = document.createElement('p');
             address.classList.add('details');
             address.textContent = placeResult.formatted_address;
             infoPane.appendChild(address);
             if (placeResult.website) {
                 let websitePara = document.createElement('p');
                 let websiteLink = document.createElement('a');
                 let websiteUrl = document.createTextNode(placeResult.website);
                 websiteLink.appendChild(websiteUrl);
                 websiteLink.title = placeResult.website;
                 websiteLink.href = placeResult.website;
                 websitePara.appendChild(websiteLink);
                 infoPane.appendChild(websitePara);
             }
         
             // Open the infoPane
             infoPane.classList.add("open");
         }







//Style Sheet Switcher version 1.1 Oct 10th, 2006
//Author: Dynamic Drive: http://www.dynamicdrive.com
//Usage terms: http://www.dynamicdrive.com/notice.htm

var manual_or_random="manual" //"manual" or "random"
var randomsetting="3 days" //"eachtime", "sessiononly", or "x days (replace x with desired integer)". Only applicable if mode is random.

//////No need to edit beyond here//////////////

function getCookie(Name) { 
var re=new RegExp(Name+"=[^;]+", "i"); //construct RE to search for target name/value pair
if (document.cookie.match(re)) //if cookie found
return document.cookie.match(re)[0].split("=")[1] //return its value
return null
}

function setCookie(name, value, days) {
var expireDate = new Date()
//set "expstring" to either future or past date, to set or delete cookie, respectively
var expstring=(typeof days!="undefined")? expireDate.setDate(expireDate.getDate()+parseInt(days)) : expireDate.setDate(expireDate.getDate()-5)
document.cookie = name+"="+value+"; expires="+expireDate.toGMTString()+"; path=/";
}

function deleteCookie(name){
setCookie(name, "moot")
}


function setStylesheet(title, randomize){ //Main stylesheet switcher function. Second parameter if defined causes a random alternate stylesheet (including none) to be enabled
var i, cacheobj, altsheets=[""]
for(i=0; (cacheobj=document.getElementsByTagName("link")[i]); i++) {
if(cacheobj.getAttribute("rel").toLowerCase()=="alternate stylesheet" && cacheobj.getAttribute("title")) { //if this is an alternate stylesheet with title
cacheobj.disabled = true
altsheets.push(cacheobj) //store reference to alt stylesheets inside array
if(cacheobj.getAttribute("title") == title) //enable alternate stylesheet with title that matches parameter
cacheobj.disabled = false //enable chosen style sheet
}
}
if (typeof randomize!="undefined"){ //if second paramter is defined, randomly enable an alt style sheet (includes non)
var randomnumber=Math.floor(Math.random()*altsheets.length)
altsheets[randomnumber].disabled=false
}
return (typeof randomize!="undefined" && altsheets[randomnumber]!="")? altsheets[randomnumber].getAttribute("title") : "" //if in "random" mode, return "title" of randomly enabled alt stylesheet
}

function chooseStyle(styletitle, days){ //Interface function to switch style sheets plus save "title" attr of selected stylesheet to cookie
if (document.getElementById){
setStylesheet(styletitle)
setCookie("mysheet", styletitle, days)
}
}

function indicateSelected(element){ //Optional function that shows which style sheet is currently selected within group of radio buttons or select menu
if (selectedtitle!=null && (element.type==undefined || element.type=="select-one")){ //if element is a radio button or select menu
var element=(element.type=="select-one") ? element.options : element
for (var i=0; i<element.length; i++){
if (element[i].value==selectedtitle){ //if match found between form element value and cookie value
if (element[i].tagName=="OPTION") //if this is a select menu
element[i].selected=true
else //else if it's a radio button
element[i].checked=true
break
}
}
}
}

if (manual_or_random=="manual"){ //IF MANUAL MODE
var selectedtitle=getCookie("mysheet")
if (document.getElementById && selectedtitle!=null) //load user chosen style sheet from cookie if there is one stored
setStylesheet(selectedtitle)
}
else if (manual_or_random=="random"){ //IF AUTO RANDOM MODE
if (randomsetting=="eachtime")
setStylesheet("", "random")
else if (randomsetting=="sessiononly"){ //if "sessiononly" setting
if (getCookie("mysheet_s")==null) //if "mysheet_s" session cookie is empty
document.cookie="mysheet_s="+setStylesheet("", "random")+"; path=/" //activate random alt stylesheet while remembering its "title" value
else
setStylesheet(getCookie("mysheet_s")) //just activate random alt stylesheet stored in cookie
}
else if (randomsetting.search(/^[1-9]+ days/i)!=-1){ //if "x days" setting
if (getCookie("mysheet_r")==null || parseInt(getCookie("mysheet_r_days"))!=parseInt(randomsetting)){ //if "mysheet_r" cookie is empty or admin has changed number of days to persist in "x days" variable
setCookie("mysheet_r", setStylesheet("", "random"), parseInt(randomsetting)) //activate random alt stylesheet while remembering its "title" value
setCookie("mysheet_r_days", randomsetting, parseInt(randomsetting)) //Also remember the number of days to persist per the "x days" variable
}
else
setStylesheet(getCookie("mysheet_r")) //just activate random alt stylesheet stored in cookie
} 
}






         
      </script>
      <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB899KkPVguq1bfhxG8YQuyCtI2TeLPjxQ&amp;libraries=places&amp;callback=initMap"></script>
      <script src="js/styleswitch.js" type="text/javascript"></script> 

   </body>
</html>
